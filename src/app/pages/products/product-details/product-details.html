<div class="container mt-4">
  <!-- En-tête avec boutons d'action -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <button mat-button (click)="onBack()" class="back-button">
      <mat-icon>arrow_back</mat-icon> Retour à la liste
    </button>
    <div class="action-buttons">
      <button mat-raised-button color="primary" (click)="onEdit()" *ngIf="product">
        <mat-icon>edit</mat-icon> Modifier
      </button>
    </div>
  </div>

  <!-- Carte principale des détails du produit -->
  <mat-card *ngIf="!isLoading && product; else loadingTemplate" class="product-card">
    <mat-card-header>
      <mat-card-title>{{ product.name }}</mat-card-title>
      <mat-card-subtitle>
        <span class="me-2">Réf: {{ product.sku }}</span>
        <span class="badge" [ngClass]="getStatusBadgeClass(product.status)">
          {{ getStatusLabel(product.status) }}
        </span>
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div class="row">
        <!-- Image du produit -->
        <div class="col-md-4 mb-4 mb-md-0">
          <div class="product-image-container">
            <img 
              [src]="product.imageUrl || 'assets/images/product-placeholder.png'" 
              [alt]="product.name"
              class="img-fluid product-image"
              onerror="this.src='assets/images/product-placeholder.png'"
            >
          </div>
        </div>

        <!-- Détails du produit -->
        <div class="col-md-8">
          <div class="product-details">
            <div class="detail-row">
              <span class="detail-label">Description:</span>
              <p class="detail-value">{{ product.description || 'Aucune description disponible' }}</p>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="detail-row">
                  <span class="detail-label">Prix:</span>
                  <span class="detail-value">{{ product.price | currency:'EUR':'symbol':'1.2-2' }}</span>
                </div>
              </div>
              <div class="col-md-6">
                <div class="detail-row">
                  <span class="detail-label">Quantité en stock:</span>
                  <span class="detail-value">{{ product.quantity }}</span>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="detail-row">
                  <span class="detail-label">Catégorie:</span>
                  <span class="detail-value">{{ product.category || 'Non spécifiée' }}</span>
                </div>
              </div>
              <div class="col-md-6">
                <div class="detail-row">
                  <span class="detail-label">Statut:</span>
                  <span class="detail-value">{{ getStatusLabel(product.status) }}</span>
                </div>
              </div>
            </div>

            <div class="detail-row" *ngIf="product.createdAt">
              <span class="detail-label">Créé le:</span>
              <span class="detail-value">{{ product.createdAt | date:'medium' }}</span>
            </div>

            <div class="detail-row" *ngIf="product.updatedAt">
              <span class="detail-label">Mis à jour le:</span>
              <span class="detail-value">{{ product.updatedAt | date:'medium' }}</span>
            </div>
          </div>
        </div>
      </div>
    </mat-card-content>

    <mat-card-actions class="mt-3">
      <button mat-button (click)="onBack()">
        <mat-icon>arrow_back</mat-icon> Retour
      </button>
      <button mat-raised-button color="primary" (click)="onEdit()" class="ms-2">
        <mat-icon>edit</mat-icon> Modifier
      </button>
    </mat-card-actions>
  </mat-card>

  <!-- Template de chargement -->
  <ng-template #loadingTemplate>
    <div class="text-center p-5" *ngIf="!error">
      <mat-spinner diameter="50"></mat-spinner>
      <p class="mt-3">Chargement des détails du produit...</p>
    </div>
  </ng-template>

  <!-- Message d'erreur -->
  <div *ngIf="error" class="alert alert-danger mt-3" role="alert">
    <mat-icon>error_outline</mat-icon> {{ error }}
    <button mat-button color="warn" (click)="onBack()" class="ms-3">
      Retour à la liste
    </button>
  </div>
</div>
